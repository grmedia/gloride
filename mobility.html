<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Greenify | Green Mobility Planner</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ===== VARIABLES (from Greenify CSS) ===== */
        :root {
            --primary: #1a6f5c;
            --primary-dark: #145a48;
            --primary-light: #2d8a72;
            --accent: #f39c12;
            --accent-dark: #d35400;
            --light: #f5f7fa;
            --dark: #1e2a38;
            --gray: #95a5a6;
            --light-gray: #e0e7e9;
            --success: #27ae60;
            --info: #3498db;
            --warning: #f1c40f;
            --danger: #e74c3c;
            --transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            --shadow-hover: 0 15px 40px rgba(0, 0, 0, 0.15);
            --corner-radius: 16px;
            --section-padding: 100px;
            --card-radius: 16px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
            overflow-x: hidden;
            position: relative;
        }
        
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 10% 20%, rgba(26, 111, 92, 0.05) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(243, 156, 18, 0.05) 0%, transparent 20%);
            z-index: -1;
            pointer-events: none;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 30px;
        }
        
        .section-padding {
            padding: var(--section-padding) 0;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 14px 32px;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            font-size: 1.05rem;
            text-align: center;
            text-decoration: none;
            gap: 8px;
        }
        
        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: var(--light);
            box-shadow: var(--shadow);
            font-weight: 700;
        }
        
        .btn-sm {
            padding: 10px 20px;
            font-size: 0.95rem;
        }
        
        .btn:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }
        
        .btn-outline:hover {
            background: rgba(26, 111, 92, 0.1);
        }
        
        /* Header */
        header {
            background: white;
            box-shadow: var(--shadow);
            padding: 1.2rem 5%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            transition: var(--transition);
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo-img {
            width: 45px;
            height: 45px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 15px rgba(26, 111, 92, 0.2);
        }
        
        .logo-img i {
            font-size: 1.5rem;
            color: white;
        }
        
        .logo-text {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary);
        }
        
        .logo-text span {
            color: var(--accent);
        }
        
        nav ul {
            display: flex;
            gap: 1.5rem;
            list-style: none;
        }
        
        nav a {
            color: var(--dark);
            text-decoration: none;
            font-weight: 500;
            padding: 0.5rem 0;
            position: relative;
            transition: var(--transition);
            font-size: 1.05rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        nav a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--accent);
            transition: var(--transition);
        }
        
        nav a:hover::after,
        nav a.active::after { /* Added .active state */
            width: 100%;
        }

        nav a.active { /* Added .active state styling */
            color: var(--primary);
            font-weight: 600;
        }
        
        .mobile-menu-btn {
            display: none;
            background: transparent;
            border: none;
            color: var(--dark);
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 1001;
            transition: var(--transition);
            width: 40px;
            height: 40px;
            position: relative;
        }
        
        .mobile-menu-btn .bar {
            display: block;
            position: absolute;
            height: 3px;
            width: 30px;
            background: var(--primary);
            border-radius: 2px;
            opacity: 1;
            left: 5px;
            transform: rotate(0deg);
            transition: var(--transition);
        }
        
        .mobile-menu-btn .bar:nth-child(1) {
            top: 10px;
        }
        
        .mobile-menu-btn .bar:nth-child(2) {
            top: 18px;
        }
        
        .mobile-menu-btn .bar:nth-child(3) {
            top: 26px;
        }
        
        .mobile-menu-btn.active .bar:nth-child(1) {
            top: 18px;
            transform: rotate(135deg);
        }
        
        .mobile-menu-btn.active .bar:nth-child(2) {
            opacity: 0;
        }
        
        .mobile-menu-btn.active .bar:nth-child(3) {
            top: 18px;
            transform: rotate(-135deg);
        }

        /* Hero Section for Mobility Planner */
        .mobility-hero {
            min-height: 60vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 140px 20px 80px;
            background: linear-gradient(rgba(245, 247, 250, 0.9), rgba(245, 247, 250, 0.9)), 
                        url('https://images.unsplash.com/photo-1517604944983-0e107f9c9689?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80'); /* Sustainable transport image */
            background-size: cover;
            background-position: center;
            position: relative;
        }
        
        .mobility-hero h1 {
            font-size: 3.5rem;
            margin-bottom: 1.5rem;
            color: var(--primary);
            max-width: 800px;
        }
        
        .mobility-hero p {
            font-size: 1.3rem;
            color: var(--gray);
            max-width: 700px;
            margin-bottom: 2.5rem;
        }

        /* Section Header Styles */
        .section-header {
            text-align: center;
            margin-bottom: 60px;
        }

        .section-header h2 {
            font-size: 2.8rem;
            color: var(--primary);
            margin-bottom: 15px;
            position: relative;
            display: inline-block;
        }

        .section-header h2::after {
            content: '';
            position: absolute;
            left: 50%;
            bottom: -10px;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background: var(--accent);
            border-radius: 2px;
        }

        .section-header p {
            font-size: 1.1rem;
            color: var(--gray);
            max-width: 700px;
            margin: 0 auto;
        }

        /* Planner Form Styles */
        .planner-form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .planner-card {
            background: white;
            border-radius: var(--corner-radius);
            box-shadow: var(--shadow);
            padding: 30px;
            transition: var(--transition);
            border-top: 5px solid var(--primary);
            display: flex;
            flex-direction: column;
        }
        
        .planner-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-hover);
            border-top-color: var(--accent);
        }

        .planner-card h3 {
            font-size: 1.8rem;
            color: var(--primary-dark);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .planner-card label {
            display: block;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--dark);
            font-size: 1rem;
        }

        .planner-card input[type="text"],
        .planner-card input[type="number"],
        .planner-card select {
            width: 100%;
            padding: 12px 15px;
            margin-bottom: 20px;
            border: 1px solid var(--light-gray);
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color var(--transition);
            -webkit-appearance: none; /* Remove default browser styling for select */
            -moz-appearance: none;
            appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%231a6f5c%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13%205.4L146.2%20224.2%2018.6%2074.9a17.6%2017.6%200%200%200-25.3%2023.7l130.8%20130.8c.4.4.8.7%201.2%201.1L146.2%20257.6l.8.8a17.6%2017.6%200%200%200%2024.7%200l130.8-130.8a17.6%2017.6%200%200%200%205.4-13.4v-1.7a17.6%2017.6%200%200%200-5.4-13.4z%22%2F%3E%3C%2Fsvg%3E'); /* Custom arrow for select */
            background-repeat: no-repeat;
            background-position: right 15px top 50%;
            background-size: 12px auto;
        }

        .planner-card input[type="text"]:focus,
        .planner-card input[type="number"]:focus,
        .planner-card select:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(26, 111, 92, 0.2);
        }
        
        .planner-card .info-text {
            font-size: 0.9rem;
            color: var(--gray);
            margin-top: -10px;
            margin-bottom: 20px;
        }

        .planner-actions {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 50px;
            margin-bottom: 50px;
        }

        #results {
            background: white;
            border-radius: var(--corner-radius);
            box-shadow: var(--shadow);
            padding: 40px;
            text-align: center;
            margin-top: 50px;
            display: none; /* Hidden by default */
        }

        #results h2 {
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 20px;
        }

        #results p {
            font-size: 1.3rem;
            color: var(--dark);
            margin-bottom: 10px;
        }

        #results .result-value {
            font-size: 3rem;
            font-weight: 700;
            color: var(--accent);
            margin-top: 20px;
            margin-bottom: 30px;
        }

        #recommendations {
            margin-top: 40px;
            text-align: left;
            border-top: 1px solid var(--light-gray);
            padding-top: 30px;
        }

        #recommendations h3 {
            font-size: 1.8rem;
            color: var(--primary-dark);
            margin-bottom: 20px;
        }

        #recommendations ul {
            list-style: none;
            padding: 0;
        }

        #recommendations li {
            background: var(--light-gray);
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 15px;
            display: flex;
            align-items: flex-start;
            gap: 15px;
            font-size: 1.05rem;
            color: var(--dark);
        }

        #recommendations li i {
            font-size: 1.5rem;
            color: var(--primary-light);
            flex-shrink: 0;
            margin-top: 3px;
        }

        .route-comparison {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }

        .route-option {
            background: var(--light-gray);
            border-radius: var(--card-radius);
            padding: 20px;
            flex: 1 1 280px; /* Allow cards to grow but maintain minimum width */
            max-width: 350px;
            text-align: left;
            box-shadow: var(--shadow);
            border-bottom: 4px solid var(--gray);
            transition: var(--transition);
        }
        .route-option:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }
        .route-option.recommended {
            border-bottom-color: var(--success);
            background-color: #e6ffe6; /* Light green background for recommended */
        }
        .route-option.less-recommended {
            border-bottom-color: var(--warning);
        }
        .route-option h4 {
            font-size: 1.4rem;
            color: var(--primary-dark);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .route-option p {
            font-size: 0.95rem;
            margin-bottom: 5px;
        }
        .route-option .emission-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary);
            margin-top: 10px;
        }
        .route-option.recommended .emission-value {
             color: var(--success);
        }

        /* Added for dynamic form elements */
        .hidden {
            display: none;
        }


        /* Responsive */
        @media (max-width: 992px) {
            .mobility-hero h1 {
                font-size: 2.8rem;
            }
            .section-header h2 {
                font-size: 2.2rem;
            }
        }
        
        @media (max-width: 768px) {
            .mobile-menu-btn {
                display: block;
            }
            
            nav ul {
                position: fixed;
                top: 0;
                right: -100%;
                height: 100vh;
                width: 280px;
                background: white;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                transition: var(--transition);
                box-shadow: -5px 0 15px rgba(0, 0, 0, 0.1);
                gap: 2rem;
                padding: 2rem;
            }
            
            nav ul.active {
                right: 0;
            }
            
            .mobility-hero {
                padding: 120px 20px 60px;
            }
            
            .mobility-hero h1 {
                font-size: 2.3rem;
            }
            
            .mobility-hero p {
                font-size: 1.1rem;
            }
            
            .section-header h2 {
                font-size: 2rem;
            }

            .planner-form-grid {
                grid-template-columns: 1fr;
            }

            .planner-actions {
                flex-direction: column;
                gap: 15px;
            }
             .route-comparison {
                flex-direction: column;
                align-items: center;
            }
            .route-option {
                max-width: 100%;
            }
        }
        
        @media (max-width: 576px) {
            .mobility-hero h1 {
                font-size: 2rem;
            }
            .section-header h2 {
                font-size: 1.8rem;
            }
            #results .result-value {
                font-size: 2.5rem;
            }
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 1s ease forwards;
            opacity: 0;
        }
        
        .delay-1 { animation-delay: 0.2s; }
        .delay-2 { animation-delay: 0.4s; }
        .delay-3 { animation-delay: 0.6s; }
        .delay-4 { animation-delay: 0.8s; }
        .delay-5 { animation-delay: 1.0s; }
        .delay-6 { animation-delay: 1.2s; }
        
        /* Scroll padding for anchor links */
        html {
            scroll-padding-top: 80px;
        }
    </style>
</head>
<body>
    <header id="header">
        <div class="logo">
            <div class="logo-img">
                <i class="fas fa-leaf"></i>
            </div>
            <div class="logo-text">Green<span>ify</span></div>
        </div>
        
        <nav>
            <button class="mobile-menu-btn" id="menuBtn">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </button>
            <ul id="navMenu">
                <li><a href="index.html"><i class="fas fa-home"></i> Home</a></li>
                <li><a href="carbon.html"><i class="fas fa-calculator"></i> Carbon</a></li>
                <li><a href="education.html"><i class="fas fa-graduation-cap"></i> Education</a></li>
                <li><a href="mobility.html"><i class="fas fa-bicycle"></i> Mobility</a></li>
                <li><a href="weather.html"><i class="fas fa-cloud-sun"></i> Weather</a></li>
                <li><a href="features.html"><i class="fas fa-sparkles"></i> Features</a></li>
                <li><a href="chatbot.html"><i class="fas fa-robot"></i> Chatbot</a></li>
                <li><a href="announcements.html"><i class="fas fa-bullhorn"></i> Announcements</a></li>
                <li><a href="blog.html" class="active"><i class="fas fa-newspaper"></i> Blog</a></li>
                <li><a href="faq.html"><i class="fas fa-question-circle"></i> FAQ</a></li>
                <li><a href="login.html"><i class="fas fa-sign-in-alt"></i> Login</a></li>
                <li><a href="signup.html"><i class="fas fa-user-plus"></i> Sign Up</a></li>
                <li><a href="settings.html"><i class="fas fa-cog"></i> Settings</a></li>
            </ul>
        </nav>
    </header>

    <section class="mobility-hero">
        <div class="container">
            <h1 class="fade-in">Greenify Mobility Planner</h1>
            <p class="fade-in delay-1">Discover the most eco-friendly ways to reach your destination. Plan smarter, travel greener.</p>
        </div>
    </section>

    <section class="section-padding">
        <div class="container">
            <div class="section-header">
                <h2 class="fade-in delay-2">Plan Your Green Journey</h2>
                <p class="fade-in delay-3">Enter your travel details to compare transportation options and their environmental impact.</p>
            </div>

            <form id="mobilityPlannerForm">
                <div class="planner-form-grid">
                    <div class="planner-card fade-in delay-4">
                        <h3><i class="fas fa-route"></i> Journey Details</h3>
                        <label for="distance">Travel Distance (km):</label>
                        <input type="number" id="distance" name="distance" value="10" min="0.1" step="0.1" required>
                        <p class="info-text">Enter the approximate one-way distance of your journey.</p>

                        <label for="terrain">Terrain Type:</label>
                        <select id="terrain" name="terrain">
                            <option value="flat">Flat</option>
                            <option value="hilly">Hilly</option>
                            <option value="urban">Urban (Stop-and-Go)</option>
                        </select>
                        <p class="info-text">This helps assess viability of walking/cycling.</p>

                        <label for="passengers">Number of Passengers (including yourself):</label>
                        <input type="number" id="passengers" name="passengers" value="1" min="1" required>
                        <p class="info-text">For shared modes like carpooling or public transport.</p>
                    </div>

                    <div class="planner-card fade-in delay-5">
                        <h3><i class="fas fa-user-check"></i> Your Preferences</h3>
                        <label for="fitnessLevel">Your Fitness Level (for active transport):</label>
                        <select id="fitnessLevel" name="fitnessLevel">
                            <option value="low">Low</option>
                            <option value="medium">Medium</option>
                            <option value="high">High</option>
                        </select>
                        <p class="info-text">Affects recommendations for walking/cycling.</p>

                        <label for="timeConstraint">Time Constraint:</label>
                        <select id="timeConstraint" name="timeConstraint">
                            <option value="flexible">Flexible (OK with longer travel)</option>
                            <option value="moderate">Moderate (Some flexibility)</option>
                            <option value="strict">Strict (Need to be fast)</option>
                        </select>
                        <p class="info-text">How much time can you allocate for travel?</p>
                        
                        <label for="weatherPreference">Weather Preference:</label>
                        <select id="weatherPreference" name="weatherPreference">
                            <option value="any">Any Weather</option>
                            <option value="good">Good Weather Only (No rain/extreme heat)</option>
                        </select>
                        <p class="info-text">For outdoor modes like walking and cycling.</p>

                        <label for="preferredMode">Preferred Mode of Transport:</label>
                        <select id="preferredMode" name="preferredMode">
                            <option value="any">Any / Flexible</option>
                            <option value="active">Active (Walk/Cycle)</option>
                            <option value="public">Public Transport</option>
                            <option value="private">Private Vehicle</option>
                        </select>
                        <p class="info-text">Choose your desired general mode of travel.</p>

                        <div id="transportTypeContainer" class="hidden">
                            <label for="transportType">Specific Transport Type:</label>
                            <select id="transportType" name="transportType">
                                </select>
                            <p class="info-text">Select a specific type within your preferred mode.</p>
                        </div>
                    </div>
                </div>

                <div class="planner-actions">
                    <button type="submit" class="btn btn-primary"><i class="fas fa-bicycle"></i> Plan My Green Route</button>
                    <button type="reset" class="btn btn-outline"><i class="fas fa-sync-alt"></i> Reset Planner</button>
                </div>
            </form>

            <div id="results" class="fade-in">
                <h2>Green Travel Options for Your Journey</h2>
                <p>Based on your input, here are your most sustainable mobility options:</p>
                
                <div class="route-comparison" id="routeComparison">
                    </div>

                <div id="recommendations">
                    <h3>Tips for Greener Travel:</h3>
                    <ul>
                        <li><i class="fas fa-tree"></i> <span id="rec1">Combine errands to reduce individual trips.</span></li>
                        <li><i class="fas fa-car-side"></i> <span id="rec2">If driving, maintain your vehicle, check tire pressure, and avoid rapid acceleration.</span></li>
                        <li><i class="fas fa-users"></i> <span id="rec3">Explore carpooling or ride-sharing options for regular commutes.</span></li>
                        <li><i class="fas fa-walking"></i> <span id="rec4">For short distances, consider walking or cycling – it's good for you and the planet!</span></li>
                    </ul>
                </div>
                <button class="btn btn-primary" onclick="window.scrollTo(0,0);"><i class="fas fa-arrow-up"></i> Back to Top</button>
            </div>
        </div>
    </section>

    <script>
        // Mobile menu toggle
        const menuBtn = document.getElementById('menuBtn');
        const navMenu = document.getElementById('navMenu');
        
        menuBtn.addEventListener('click', function() {
            menuBtn.classList.toggle('active');
            navMenu.classList.toggle('active');
        });

        // Close menu when clicking a link
        const navLinks = document.querySelectorAll('#navMenu a');
        navLinks.forEach(link => {
            link.addEventListener('click', () => {
                menuBtn.classList.remove('active');
                navMenu.classList.remove('active');
            });
        });
        
        // Header scroll effect
        window.addEventListener('scroll', function() {
            const header = document.getElementById('header');
            if (window.scrollY > 50) {
                header.style.boxShadow = '0 5px 20px rgba(0, 0, 0, 0.1)';
            } else {
                header.style.boxShadow = 'var(--shadow)';
            }
        });

        // --- Green Mobility Planner Logic ---
        const preferredModeSelect = document.getElementById('preferredMode');
        const transportTypeContainer = document.getElementById('transportTypeContainer');
        const transportTypeSelect = document.getElementById('transportType');

        const transportTypeOptions = {
            'active': [
                { value: 'walk', text: 'Walk' },
                { value: 'cycle', text: 'Cycle' }
            ],
            'public': [
                { value: 'publicBus', text: 'Public Bus' },
                { value: 'publicTrain', text: 'Train/Tram' }
            ],
            'private': [
                { value: 'carPetrol', text: 'Petrol/Diesel Car' },
                { value: 'carElectric', text: 'Electric Car' },
                { value: 'carHybrid', text: 'Hybrid Car' },
                { value: 'motorcycle', text: 'Motorcycle' }
            ]
        };

        // Function to update transport type options based on preferred mode
        function updateTransportTypeOptions() {
            const selectedMode = preferredModeSelect.value;
            transportTypeSelect.innerHTML = ''; // Clear existing options

            if (selectedMode === 'any') {
                transportTypeContainer.classList.add('hidden');
                // Add a "Any Type" option if preferred mode is "Any"
                const defaultOption = document.createElement('option');
                defaultOption.value = 'any';
                defaultOption.textContent = 'Any Type';
                transportTypeSelect.appendChild(defaultOption);
            } else {
                transportTypeContainer.classList.remove('hidden');
                const options = transportTypeOptions[selectedMode];
                options.forEach(optionData => {
                    const option = document.createElement('option');
                    option.value = optionData.value;
                    option.textContent = optionData.text;
                    transportTypeSelect.appendChild(option);
                });
            }
        }

        // Event listener for preferred mode change
        preferredModeSelect.addEventListener('change', updateTransportTypeOptions);

        // Initialize transport type options on page load
        document.addEventListener('DOMContentLoaded', updateTransportTypeOptions);


        document.getElementById('mobilityPlannerForm').addEventListener('submit', function(event) {
            event.preventDefault();

            // Get input values
            const distance = parseFloat(document.getElementById('distance').value);
            const terrain = document.getElementById('terrain').value;
            const passengers = parseInt(document.getElementById('passengers').value);
            const fitnessLevel = document.getElementById('fitnessLevel').value;
            const timeConstraint = document.getElementById('timeConstraint').value;
            const weatherPreference = document.getElementById('weatherPreference').value;
            const preferredMode = preferredModeSelect.value;
            const specificTransportType = transportTypeSelect.value;


            // Emission factors (kg CO2e per km per passenger - simplified)
            const EMISSION_FACTORS = {
                walk: 0, // Zero direct emissions
                cycle: 0, // Zero direct emissions
                publicBus: 0.10, // Average bus in kg CO2e/passenger-km
                publicTrain: 0.04, // Average train/tram kg CO2e/passenger-km
                carPetrol: 0.192, // kg CO2e/km, adjust for passengers
                carElectric: 0.02, // kg CO2e/km (grid dependent, assume relatively clean)
                carHybrid: 0.12, // kg CO2e/km
                motorcycle: 0.11 // kg CO2e/km
            };

            // Average speeds (km/h) and base times
            const SPEEDS = {
                walk: 5,
                cycle: 15,
                publicBus: 20, // Accounts for stops
                publicTrain: 40, // Accounts for stops
                car: 40, // Average urban speed
                motorcycle: 40
            };

            // --- Function for Walking-specific notes ---
            function getWalkNotes(walkTimeInMinutes) {
                if (walkTimeInMinutes <= 15) {
                    return `Perfect for a quick, healthy commute! Enjoy the fresh air.`;
                } else if (walkTimeInMinutes <= 45) {
                    return `A great way to get your steps in and explore. Consider comfortable shoes!`;
                } else {
                    return `A longer walk. Ideal for leisure or if you have ample time and good fitness.`;
                }
            }


            let potentialRouteOptions = [];

            // Define all possible route options with their properties
            const allRouteOptions = [
                {
                    mode: 'Walk',
                    type: 'walk',
                    category: 'active',
                    icon: 'fas fa-walking',
                    calculate: () => {
                        let walkTime = distance / SPEEDS.walk;
                        let walkTimeInMinutes = walkTime * 60;
                        let viable = true;
                        // Viability checks
                        if (distance > 5 && fitnessLevel === 'low') viable = false;
                        if (distance > 10 && (fitnessLevel === 'low' || fitnessLevel === 'medium')) viable = false;
                        if (timeConstraint === 'strict' && walkTime > 0.5) viable = false;
                        if (weatherPreference === 'good' && (false /* actual bad weather check */)) viable = false; // Placeholder for weather, needs real integration
                        
                        return viable ? {
                            emissions: 0,
                            time: `${walkTimeInMinutes.toFixed(0)} mins`,
                            notes: getWalkNotes(walkTimeInMinutes) 
                        } : null;
                    }
                },
                {
                    mode: 'Cycle',
                    type: 'cycle',
                    category: 'active',
                    icon: 'fas fa-bicycle',
                    calculate: () => {
                        let cycleTime = distance / SPEEDS.cycle;
                        let viable = true;
                        // Viability checks
                        if (distance > 10 && fitnessLevel === 'low') viable = false;
                        if (distance > 25 && (fitnessLevel === 'low' || fitnessLevel === 'medium')) viable = false;
                        if (terrain === 'hilly' && fitnessLevel === 'low') viable = false;
                        if (timeConstraint === 'strict' && cycleTime > 0.5) viable = false;
                        if (weatherPreference === 'good' && (false /* actual bad weather check */)) viable = false; // Placeholder for weather

                        let notes = 'Zero emissions, healthy, and often faster than cars in urban areas.';
                        if (terrain === 'hilly' && fitnessLevel === 'medium') notes += ' Hills might be a challenge, but rewarding!';
                        return viable ? {
                            emissions: 0,
                            time: `${(cycleTime * 60).toFixed(0)} mins`,
                            notes: notes
                        } : null;
                    }
                },
                {
                    mode: 'Public Bus',
                    type: 'publicBus',
                    category: 'public',
                    icon: 'fas fa-bus',
                    calculate: () => {
                        let busEmissions = EMISSION_FACTORS.publicBus * distance * passengers;
                        let busTime = distance / SPEEDS.publicBus;
                        let viable = true;
                        // Viability checks
                        if (distance < 2 && timeConstraint === 'flexible') viable = false; // Maybe walking is better for very short flexible trips
                        if (timeConstraint === 'strict' && busTime > 1.5) viable = false; // Bus might be too slow for strict constraints on long trips

                        let notes = `Lower emissions per person than cars, especially with multiple passengers.`;
                        if (terrain === 'urban') notes += ' Expect potential delays due to traffic.';
                        return viable ? {
                            emissions: busEmissions,
                            time: `${(busTime * 60).toFixed(0)} mins (+ waiting)`,
                            notes: notes
                        } : null;
                    }
                },
                {
                    mode: 'Train/Tram',
                    type: 'publicTrain',
                    category: 'public',
                    icon: 'fas fa-train',
                    calculate: () => {
                        let trainEmissions = EMISSION_FACTORS.publicTrain * distance * passengers;
                        let trainTime = distance / SPEEDS.publicTrain;
                        let viable = true;
                        // Viability checks
                        if (distance < 5) viable = false; // Not efficient for very short distances
                        if (timeConstraint === 'strict' && trainTime > 1.0) viable = false; // Long train trips might still be too long

                        let notes = `One of the most efficient modes for longer commutes.`;
                        if (distance >= 20) notes += ' Excellent for longer, inter-city travel.';
                        return viable ? {
                            emissions: trainEmissions,
                            time: `${(trainTime * 60).toFixed(0)} mins (+ waiting)`,
                            notes: notes
                        } : null;
                    }
                },
                {
                    mode: 'Petrol/Diesel Car',
                    type: 'carPetrol',
                    category: 'private',
                    icon: 'fas fa-car',
                    calculate: () => {
                        let carPetrolEmissions = (EMISSION_FACTORS.carPetrol * distance) / passengers;
                        let carTime = distance / SPEEDS.car;
                        
                        let notes = 'Higher emissions, especially with fewer passengers.';
                        if (passengers > 1) notes += ' Carpooling helps reduce per-person impact.';
                        else notes += ' Consider carpooling or public transport for greener options.';
                        return {
                            emissions: carPetrolEmissions,
                            time: `${(carTime * 60).toFixed(0)} mins`,
                            notes: notes
                        };
                    }
                },
                {
                    mode: 'Electric Car',
                    type: 'carElectric',
                    category: 'private',
                    icon: 'fas fa-car-battery',
                    calculate: () => {
                        let carElectricEmissions = (EMISSION_FACTORS.carElectric * distance) / passengers;
                        let carTime = distance / SPEEDS.car;
                        
                        let notes = 'Zero tailpipe emissions, overall impact depends on electricity source.';
                        notes += ' Charge with renewable energy if possible!';
                        return {
                            emissions: carElectricEmissions,
                            time: `${(carTime * 60).toFixed(0)} mins`,
                            notes: notes
                        };
                    }
                },
                {
                    mode: 'Hybrid Car',
                    type: 'carHybrid',
                    category: 'private',
                    icon: 'fas fa-car-side',
                    calculate: () => {
                        let carHybridEmissions = (EMISSION_FACTORS.carHybrid * distance) / passengers;
                        let carTime = distance / SPEEDS.car;
                        
                        let notes = 'Better than petrol, but still uses fossil fuels. Ideal for mixed driving.';
                        if (terrain === 'urban') notes += ' Hybrids perform well in stop-and-go traffic.';
                        return {
                            emissions: carHybridEmissions,
                            time: `${(carTime * 60).toFixed(0)} mins`,
                            notes: notes
                        };
                    }
                },
                {
                    mode: 'Motorcycle',
                    type: 'motorcycle',
                    category: 'private',
                    icon: 'fas fa-motorcycle',
                    calculate: () => {
                        if (passengers > 2) return null; // Not viable for more than 2
                        let motorcycleEmissions = (EMISSION_FACTORS.motorcycle * distance) / passengers;
                        let motorcycleTime = distance / SPEEDS.motorcycle;
                        
                        let notes = 'Generally lower emissions than a car, but higher per-person than public transport.';
                        if (passengers === 1) notes += ' Most efficient for solo travel among private vehicles.';
                        return {
                            emissions: motorcycleEmissions,
                            time: `${(motorcycleTime * 60).toFixed(0)} mins`,
                            notes: notes
                        };
                    }
                }
            ];

            allRouteOptions.forEach(optionTemplate => {
                let shouldInclude = false;
                if (preferredMode === 'any') {
                    shouldInclude = true;
                } else if (preferredMode === optionTemplate.category) {
                    if (specificTransportType === 'any' || specificTransportType === optionTemplate.type) {
                        shouldInclude = true;
                    }
                }

                if (shouldInclude) {
                    const result = optionTemplate.calculate();
                    if (result) {
                        // **KEY FIX HERE: Use result.emissions and result.time**
                        potentialRouteOptions.push({
                            mode: optionTemplate.mode,
                            type: optionTemplate.type, // Added type for more precise filtering
                            category: optionTemplate.category, // Added category for more precise filtering
                            icon: optionTemplate.icon,
                            emissions: result.emissions,
                            time: result.time,
                            distance: `${distance.toFixed(1)} km`,
                            notes: result.notes
                        });
                    }
                }
            });

            // Sort options by emissions (lowest first)
            potentialRouteOptions.sort((a, b) => a.emissions - b.emissions);

            // Display Results
            const routeComparisonDiv = document.getElementById('routeComparison');
            routeComparisonDiv.innerHTML = ''; // Clear previous results

            if (potentialRouteOptions.length === 0) {
                routeComparisonDiv.innerHTML = '<p class="error-message"><i class="fas fa-exclamation-circle"></i> No suitable options found based on your preferences. Try adjusting your selections!</p>';
            } else {
                potentialRouteOptions.forEach((option, index) => {
                    const optionDiv = document.createElement('div');
                    optionDiv.classList.add('route-option');
                    
                    // Refined recommendation class logic:
                    // If 'any' mode is selected, highlight the top 2 greenest.
                    // If a specific mode/type is selected, highlight that option.
                    // Always highlight if emissions are 0 (walk/cycle).
                    let isRecommended = false;
                    if (option.emissions === 0) {
                        isRecommended = true; // Always recommend zero-emission options
                    } else if (preferredMode === 'any') {
                        if (index < 2) { // Highlight the top 2 overall greenest options
                            isRecommended = true;
                        }
                    } else if (specificTransportType === option.type) {
                        isRecommended = true; // Highlight the specific type chosen by the user
                    } else if (preferredMode === option.category && specificTransportType === 'any' && index === 0) {
                        // If user chose a category (e.g., 'public') but 'any type' within it,
                        // highlight the greenest within that category.
                        // This logic needs to be careful if other categories are present at index 0.
                        // A more robust way might be to find the greenest within the chosen category first.
                        const greenestInCategory = potentialRouteOptions.find(opt => opt.category === preferredMode);
                        if (greenestInCategory && greenestInCategory.type === option.type) {
                            isRecommended = true;
                        }
                    }

                    if (isRecommended) {
                        optionDiv.classList.add('recommended');
                    } else if (option.emissions > 0.1 && option.emissions <= 0.5) {
                        optionDiv.classList.add('less-recommended');
                    }

                    optionDiv.innerHTML = `
                        <h4><i class="${option.icon}"></i> ${option.mode}</h4>
                        <p><strong>Travel Time:</strong> ${option.time}</p>
                        <p><strong>Distance:</strong> ${option.distance}</p>
                        <p><strong>Notes:</strong> ${option.notes}</p>
                        <p class="emission-value"><strong>Est. CO2e:</strong> ${option.emissions.toFixed(2)} kg</p>
                    `;
                    routeComparisonDiv.appendChild(optionDiv);
                });
            }

            // Update general recommendations based on top modes
            updateGeneralRecommendations(potentialRouteOptions[0] ? potentialRouteOptions[0].mode : null);

            document.getElementById('results').style.display = 'block';
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        });

        // Function to update personalized recommendations
        function updateGeneralRecommendations(topMode) {
            const rec1 = document.getElementById('rec1');
            const rec2 = document.getElementById('rec2');
            const rec3 = document.getElementById('rec3');
            const rec4 = document.getElementById('rec4');

            rec1.innerHTML = 'Combine errands to reduce individual trips.';
            rec2.innerHTML = 'If driving, maintain your vehicle, check tire pressure, and avoid rapid acceleration.';
            rec3.innerHTML = 'Explore carpooling or ride-sharing options for regular commutes.';
            rec4.innerHTML = 'For short distances, consider walking or cycling – it\'s good for you and the planet!';

            if (topMode === 'Walk' || topMode === 'Cycle') {
                rec4.innerHTML = `Excellent! ${topMode}ing is one of the best ways to reduce your footprint and stay healthy. Keep it up!`;
            } else if (topMode === 'Public Bus' || topMode === 'Train/Tram') {
                rec3.innerHTML = `Public transport is a great choice! Support and utilize local public transportation networks.`;
            } else if (topMode === 'Electric Car') {
                rec2.innerHTML = `Electric vehicles are a step in the right direction. Consider charging during off-peak hours or with renewable energy sources.`;
            }
        }

        // Initialize fade-in animations on page load
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.fade-in').forEach((element, index) => {
                element.style.animationDelay = `${index * 0.1}s`;
                element.classList.add('animated'); 
            });
        });
    </script>
</body>
</html>
